{"version":3,"file":"static/js/271.b642c03a.chunk.js","mappings":"oLACA,EAAsB,sB,SCgBhBA,EAAW,WACb,OAAkCC,EAAAA,EAAAA,UAA2B,MAAK,eAA3DC,EAAS,KAAEC,EAAY,KAe9B,OAbAC,EAAAA,EAAAA,YAAU,WAEFD,EAAa,IAAIE,UAAU,gEAInC,GAAE,KACFD,EAAAA,EAAAA,YAAU,WACG,OAATF,QAAS,IAATA,GAAAA,EAAWI,iBAAiB,SAAS,WACjCC,QAAQC,IAAI,WAChB,GACJ,GAAE,CAACN,KAEI,4BACH,SAACO,EAAQ,CAACP,UAAWA,KACrB,SAACQ,EAAc,CAACR,UAAWA,MAEnC,EACMO,EAA8C,SAAH,GAAqB,IAAhBP,EAAS,EAATA,UAClD,GAAgCD,EAAAA,EAAAA,UAA4B,IAAG,eAAxDU,EAAQ,KAAEC,EAAW,KAS5B,OAPAR,EAAAA,EAAAA,YAAU,WACG,OAATF,QAAS,IAATA,GAAAA,EAAWI,iBAAiB,WAAW,SAACO,GACpC,IAAIC,EAAcC,KAAKC,MAAMH,EAAEI,MAC/BL,GAAY,SAACM,GAAY,wBAASA,IAAY,OAAKJ,GAAW,GAClE,GACJ,GAAG,CAACZ,KAEG,gBAAKiB,MAAO,CAACC,OAAQ,QAASC,UAAW,QAAQ,SACnDV,EAASW,KAAI,SAACC,EAAGC,GAAK,OAAK,SAACC,EAAO,CAAaC,QAASH,GAAhBC,EAAoB,KAGtE,EACMC,EAA4C,SAAH,GAAmB,IAAdC,EAAO,EAAPA,QAChD,OAAO,4BACH,gBAAKC,UAAWC,EAAOC,IAAKH,EAAQI,QAAQ,KAAC,uBAAIJ,EAAQK,YACzD,kBACCL,EAAQA,SACT,oBAER,EAGMhB,EAAoD,SAAH,GAAqB,IAAhBR,EAAS,EAATA,UACxD,GAA8BD,EAAAA,EAAAA,UAAS,IAAG,eAAnCyB,EAAO,KAAEM,EAAU,KAC1B,GAAsC/B,EAAAA,EAAAA,UAA8B,WAAU,eAAvEgC,EAAW,KAAEC,EAAc,MAElC9B,EAAAA,EAAAA,YAAU,WACG,OAATF,QAAS,IAATA,GAAAA,EAAWI,iBAAiB,QAAQ,WAChC4B,EAAe,QACnB,GACJ,GAAE,CAAChC,IAQH,OAAO,4BACH,0BACI,qBAAUiC,SAAU,SAACtB,GAAC,OAAKmB,EAAWnB,EAAEuB,cAAcC,MAAM,EAAEA,MAAOX,OAEzE,0BACI,mBAAQY,SAAwB,OAAdpC,GAAsC,UAAhB+B,EAAyBM,QAZrD,WACXb,IAGI,OAATxB,QAAS,IAATA,GAAAA,EAAWsC,KAAKd,GAChBM,EAAW,IACf,EAM8F,SAAC,aAInG,EAEA,EA/EqB,WACjB,OAAO,0BACH,SAAChC,EAAI,KAEb,C","sources":["webpack://my-app/./src/pages/Chat/ChatPage.module.css?29d9","pages/Chat/ChatPage.tsx"],"sourcesContent":["// extracted by mini-css-extract-plugin\nexport default {\"pic\":\"ChatPage_pic__5XMob\"};","import {FC, useEffect, useState} from \"react\";\nimport pic from \"../../assets/friend2.png\"\nimport s from \"./ChatPage.module.css\"\n\n\nexport type ChatMessageType = {\n    message: string\n    photo: string\n    userId: number\n    userName: string\n}\nconst ChatPage: FC = () => {\n    return <div>\n        <Chat/>\n    </div>\n}\n\nconst Chat: FC = () => {\n    const [wsChannel, setWsChannel] = useState<WebSocket | null>(null)\n\n    useEffect(()=>{\n        function createChannel(){\n            setWsChannel(new WebSocket('wss://social-network.samuraijs.com/handlers/ChatHandler.ashx'))\n        }\n        createChannel();\n\n    },[])\n    useEffect(()=>{\n        wsChannel?.addEventListener('close', ()=>{\n            console.log('CLOSE WS')\n        })\n    },[wsChannel])\n\n    return <div>\n        <Messages wsChannel={wsChannel}/>\n        <AddMessageForm wsChannel={wsChannel}/>\n    </div>\n}\nconst Messages: FC<{wsChannel: WebSocket | null}> = ({wsChannel}) => {\n    const [messages, setMessages] = useState<ChatMessageType[]>([])\n\n    useEffect(() => {\n        wsChannel?.addEventListener('message', (e: MessageEvent) => {\n            let newMessages = JSON.parse(e.data);\n            setMessages((prevMessages) => [...prevMessages, ...newMessages])\n        })\n    }, [wsChannel])\n\n    return <div style={{height: \"400px\", overflowY: \"auto\"}}>\n        {messages.map((m, index) => <Message key={index} message={m}/>)}\n\n    </div>\n}\nconst Message: FC<{ message: ChatMessageType }> = ({message}) => {\n    return <div>\n        <img className={s.pic} src={message.photo}/> <b>{message.userName}</b>\n        <br/>\n        {message.message}\n        <hr/>\n    </div>\n}\n\n\nconst AddMessageForm: FC<{wsChannel: WebSocket | null}> = ({wsChannel}) => {\n    const [message, setMessage] = useState('');\n    const [readyStatus, setReadyStatus] = useState<'pending' | 'ready'>('pending');\n\n    useEffect(() => {\n        wsChannel?.addEventListener('open', () => {\n            setReadyStatus('ready')\n        })\n    },[wsChannel])\n    const sendMessage = () => {\n        if (!message) {\n            return\n        }\n        wsChannel?.send(message)\n        setMessage('')\n    }\n    return <div>\n        <div>\n            <textarea onChange={(e) => setMessage(e.currentTarget.value)} value={message}></textarea>\n        </div>\n        <div>\n            <button disabled={wsChannel === null || readyStatus !== 'ready'} onClick={sendMessage}>Send</button>\n        </div>\n\n    </div>\n}\n\nexport default ChatPage;"],"names":["Chat","useState","wsChannel","setWsChannel","useEffect","WebSocket","addEventListener","console","log","Messages","AddMessageForm","messages","setMessages","e","newMessages","JSON","parse","data","prevMessages","style","height","overflowY","map","m","index","Message","message","className","s","src","photo","userName","setMessage","readyStatus","setReadyStatus","onChange","currentTarget","value","disabled","onClick","send"],"sourceRoot":""}